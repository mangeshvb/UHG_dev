<apex:page controller="ACETProviderNotFoundController" sidebar="false" tabStyle="Provider_Search__tab">
    <apex:includeScript value="/support/console/37.0/integration.js"/>
    <apex:includeScript value="{!$Resource.JQuery}"></apex:includeScript>
    <apex:sectionHeader title="Enter Provider Information"/>
    <apex:form >
        <apex:pageMessages id="pmMessages"/>
        <apex:pageBlock Id="pbProviderNotFound" >
            <apex:pageblockSection columns="2">
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="{!$Label.ACETProviderSearchContactNameLabel}"></apex:outputLabel>
                    <apex:inputText value="{!ContactName}" id="ContactName"  maxlength="100"/>                        
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value=""></apex:outputLabel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="{!$Label.ACETProviderSearchTaxIdLabel}"></apex:outputLabel>
                    <apex:inputText value="{!TaxId}" id="TaxId" maxlength="9"/>                       
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="{!$Label.ACETProviderSearchNPILabel}"></apex:outputLabel>
                    <apex:inputText value="{!NPI}" id="NPI" maxlength="10"/>                        
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="{!$Label.ACETProviderSearchLastNameLabel}"></apex:outputLabel>
                    <apex:outputPanel >
                        <div class="requiredInput">
                            <div class="requiredBlock"/><apex:inputText value="{!LastName}" id="LastName" maxlength="80"/> 
                        </div>
                    </apex:outputPanel>
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >        
                    <apex:outputLabel value="{!$Label.ACETProviderSearchFirstNameLabel}"></apex:outputLabel>
                    <apex:outputPanel >
                        <div class="requiredInput">
                            <div class="requiredBlock"/><apex:inputText value="{!FirstName}" id="FirstName" maxlength="40"/>
                        </div>
                    </apex:outputPanel>                                            
                </apex:pageBlockSectionItem>
                <apex:pageBlockSectionItem >
                    <apex:outputLabel value="{!$Label.ACETProviderSearchPhoneNumberLabel}"></apex:outputLabel>
                    <apex:outputPanel >
                        <div class="requiredInput">
                            <div class="requiredBlock"/><apex:inputText value="{!phoneNumber}" id="PhoneNumber" maxlength="10"/>
                        </div>
                    </apex:outputPanel>                    
                </apex:pageBlockSectionItem>                         
            </apex:pageblockSection>
            <apex:pageBlockButtons location="bottom" style="align:center;">
                <apex:commandButton value="Submit" action="{!RedirectFromProviderNotFound}" onclick="return validate()"/>
                <apex:commandButton value="Cancel" onclick="testCloseTab()"/>
            </apex:pageBlockButtons>      
        </apex:pageBlock>
    </apex:form>
    <script type="text/javascript">
    
    var j$ = jQuery.noConflict();
    var $ProviderNotFound = j$("[id$='pbProviderNotFound']");
    var $ContactName  = j$("[id$='ContactName']");
    var $FirstName   = j$("[id$='FirstName']");
    var $LastName    = j$("[id$='LastName']");
    var $TaxId       = j$("[id$='TaxId']");
    var $NPI         = j$("[id$='NPI']");
    var $PhoneNumber = j$("[id$='PhoneNumber']");
    
    
    function validate() 
    {  
        $ProviderNotFound.find(".pbError").remove(); 
        $FirstName.removeClass("error").parent().find(".errorMsg").remove();
        $LastName.removeClass("error").parent().find(".errorMsg").remove();
        $TaxId.removeClass("error").parent().find(".errorMsg").remove();
        $NPI.removeClass("error").parent().find(".errorMsg").remove();
        $PhoneNumber.removeClass("error").parent().find(".errorMsg").remove();

        var ValidationResult = true;
        if($TaxId.val()) {
         if($TaxId.val().length < 9) { 
             $TaxId.addClass("error").parent().append('<div class="errorMsg"><strong>Error:</strong>&nbsp;{!$Label.ACETProviderNotFoundTaxIDMaxLength}</div>'); 
             ValidationResult = false;
         }          
        }
        if($NPI.val()) {
         if($NPI.val().length < 10) {                   
             $NPI.addClass("error").parent().append('<div class="errorMsg"><strong>Error:</strong>&nbsp;{!$Label.ACETProviderNotFoundNPIMaxLength}</div>');
             ValidationResult = false;
         }
        }
        if($PhoneNumber.val()) {
         if($PhoneNumber.val().length < 10) {                 
             $PhoneNumber.addClass("error").parent().append('<div class="errorMsg"><strong>Error:</strong>&nbsp;{!$Label.ACETProviderNotFoundPhoneNumberMaxLength}</div>');  
             ValidationResult = false;
         }
        }
        if(!$PhoneNumber.val()) {
         $PhoneNumber.addClass("error").parent().append('<div class="errorMsg"><strong>Error:</strong>&nbsp;{!$Label.ACETProviderNotFoundPhoneNumberRequired}</div>'); 
         ValidationResult = false;
        }
        if(!$LastName.val()) {
         $LastName.addClass("error").parent().append('<div class="errorMsg"><strong>Error:</strong>&nbsp;{!$Label.ACETProviderNotFoundLastNameRequired}</div>'); 
         ValidationResult = false;  
        }
        if(!$FirstName.val()) {
         $FirstName.addClass("error").parent().append('<div class="errorMsg"><strong>Error:</strong>&nbsp;{!$Label.ACETProviderNotFoundFirstNameRequired}</div>'); 
         ValidationResult = false;
        }
        if (!ValidationResult)
        {
         $ProviderNotFound.prepend('<div class="pbError">{!$Label.ACETProviderSearchInvalidDataErrorMessage}<br/>{!$Label.ACETProviderSearchReviewErrorMessage}</div>');
        }
        return ValidationResult;    
    }
    
    
    function init()
    {
        $TaxId.keypress(AllowDigitsOnly); 
        $NPI.keypress(AllowDigitsOnly); 
        $PhoneNumber.keypress(AllowDigitsOnly);   
    }
    
    function AllowDigitsOnly(InputElement) 
    {
        //Allow delete, tab, enter and escape keys through
        if (/^(8|9|13|27)$/.test("" + InputElement.keyCode)) 
        {
            return true;
        }
        
        var regex = new RegExp("^[0-9]+$");
        var str = String.fromCharCode(!InputElement.charCode ? InputElement.which : InputElement.charCode);
        if (regex.test(str)) 
        {
            return true;
        }
        
        InputElement.preventDefault();
        return false;
    }
    
    
    j$(document).ready(function() {          
        init();
        
    }); 
    
    function testCloseTab() {
        sforce.console.getEnclosingTabId(closeSubtab);
    }
    
    var closeSubtab = function closeSubtab(result) {
        //Now that we have the tab ID, we can close it
        var tabId = result.id;
        sforce.console.closeTab(tabId);
    };
    </script>
</apex:page>