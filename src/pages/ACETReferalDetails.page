<apex:page controller="ACETReferralDetailsController" sidebar="False" title="Referral Details">
	<apex:includeScript value="{!$Resource.JQuery}" />
    <apex:includeScript value="{!URLFOR($Resource.ACETResources, '/js/main.js')}" />
    <apex:includeScript value="{!$Resource.JqueryTableSorter}"></apex:includeScript>
    <apex:includeScript value="/support/console/30.0/integration.js" />
    <apex:stylesheet value="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css" />
    <apex:includeScript value="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></apex:includeScript>
    <apex:form >
        <c:ACETInteractionHighlightsPanel InteractionAtt="{!Interaction}" SubjectAtt="{!Subject}" AdditionalInfoAtt="{!AdditionalInfo}"/>
        

        <script type="text/javascript">
 		$(document).ready(function() {     
            acet.autodoc.startAutodoc();
            acet.autodoc.createCommentsbox();
            
            //send over referral detail autodoc to referral search when requested
            var subjectId = '{!Subject.Id}';
            sforce.console.addEventListener('RequestReferralDetail_'.concat(subjectId), function(r){ 
                sforce.console.getEnclosingTabId(function(result){                                        
                    var res = {};   
                    res.subTabId = result.id;           
                    res.doc = acet.autodoc.saveAutodoc(); 
                                                                                       
                    sforce.console.fireEvent('ReceiveReferralDetail_'.concat(subjectId), JSON.stringify(res)); 
                }); 
                                                       
            });
            
            //sync comments between claim search and claim details tabs
            $("#autodocComments").keyup(function(){
                sforce.console.fireEvent('ReferralCommentsUpdated_'.concat(subjectId), $("#autodocComments").val());    
            }); 
            
            sforce.console.addEventListener('ReferralCommentsUpdated_'.concat(subjectId), function(r){
                $("#autodocComments").val(r.message);
            });
      });
 </script>
        <apex:sectionHeader title="Referral" subtitle="{!referralID}" />
        <apex:pageBlock mode="maindetail" id="maindetailPageBlock"
            title="Referral Details">
            <apex:pageblock >
                <apex:pageBlockSection columns="1" html-auto-doc="true" html-auto-doc-case-items="true">
                    <apex:pageBlockTable value="{!wrapperresults1}" var="w" id="results-table" style="border:none">
                        <apex:column value="{!w.resultreferralExternalID}" headerValue="Referral Number" />
                        <apex:column value="{!w.resultReferaltype}" headerValue="Referral Type" />
                        <apex:column value="{!w.resultReferralStatus}" headerValue="Referral Status" />
                        <apex:column value="{!w.resultStartdate}" headerValue="Start Date" />
                        <apex:column value="{!w.resultEnddate}" headerValue="End Date" />
                        <apex:column value="{!w.resultRequestingtin}" headerValue="Requesting TIN" />
                        <apex:column value="{!w.resultRequestingprovider}" headerValue="Requesting Provider" />
                        <apex:column value="{!w.resultServicingtin}" headerValue="Servicing TIN" />
                        <apex:column value="{!w.resultServicingprovider}" headerValue="Servicing Provider" />
                        <apex:column value="{!w.resultDxcode}" headerValue="Dx Code" />
                        <apex:column value="{!w.resultDXDescription }" headerValue="Dx Description" />
                    </apex:pageBlockTable>
				</apex:pageBlockSection>
            </apex:pageblock>
            
            <apex:pageBlock title="Providers">
				<apex:pageblockSection columns="1" html-auto-doc="true">
                    <apex:pageBlockTable value="{!wrapperresults1.providerlst}" var="rd"
                        title="Providers">
                        <apex:column headerValue="Provider Role" value="{!rd.resultProviderRole}"/>
                        <apex:column headerValue="Provider ID" value="{!rd.resultMPIN}" />
                        <apex:column headerValue="Name" value="{!rd.resultName}" />
                        <apex:column headerValue="TIN" value="{!rd.resultTIN}"/>
                        <apex:column headerValue="Address" value="{!rd.resultAddress}" />
                        <apex:column headerValue="City" value="{!rd.resultCity}"/>
                        <apex:column headerValue="State" value="{!rd.resultState}" />
                        <apex:column headerValue="Zip" value="{!rd.resultZip}"/>
                        <apex:column headerValue="Specialty" value="{!rd.speciality}"/>
                    </apex:pageBlockTable>
                    </apex:pageblocksection>
            </apex:pageBlock>
            <apex:pageBlock title="Summary Information">
                <apex:pageblockSection columns="1" html-auto-doc="true">
                    <apex:pageBlockTable value="{!wrapperresults1}" var="si" title="Summary Information">
                        <apex:column headerValue="Created Date/Time" value="{!si.resultCreatedDate}" />
                        <apex:column headerValue="Referral Type" value="{!si.resultReferaltype}" />
                        <apex:column headerValue="Number of Visits" value="{!si.numberofvisit}"/>
                        <apex:column headerValue="Start Date" value="{!si.resultStartdate}"/>
                        <apex:column headerValue="End Date" value="{!si.resultEnddate}"/>

                    </apex:pageBlockTable>
                    </apex:pageblocksection>
            </apex:pageBlock>

            <apex:pageBlock title="Diagnosis">
                <apex:pageblockSection columns="1" html-auto-doc="true">
                    <apex:pageBlockTable value="{!wrapperresults1}" var="dg" title="Diagnosis">
                       <apex:column value="{!dg.resultDxcode}" headerValue="Dx Code" />
                       <apex:column value="{!dg.resultDXDescription }" headerValue="Dx Description" />
					</apex:pageBlockTable>
                    </apex:pageblocksection>
            </apex:pageBlock>
            <apex:pageBlock title="Procedure">
                <apex:pageblockSection columns="1" html-auto-doc="true">
                    <apex:pageBlockTable value="{!wrapperresults1.servicelst}" var="pt" title="Procedure">
                        <apex:column headerValue="Procedure Type" value="{!pt.resultProcedureType}"/>
                        <apex:column headerValue="Procedure Code" value="{!pt.resultProcedureCode}"/>
                        <apex:column headerValue="Description" value="{!pt.resultDescription}"/>
					</apex:pageBlockTable>
                    </apex:pageblocksection>
            </apex:pageBlock>

            <apex:pageBlock title="Notes">
                <apex:pageblockSection columns="1" html-auto-doc="true">
                    <apex:pageBlockTable value="{!wrapperresults1}" var="note" title="Notes">
                        <apex:column headerValue="Notes" value="{!note.Notetext}"/>
					</apex:pageBlockTable>
                    </apex:pageblocksection>
            </apex:pageBlock>
        </apex:pageBlock>
    </apex:form>

</apex:page>